<!DOCTYPE html>
<html lang="en">
    <head>
        <title>three.js webgl - arcball controls</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
        <link type="text/css" rel="stylesheet" href="main.css" />
    </head>

    <body>
        <div id="info">
            <a href="https://threejs.org" target="_blank" rel="noopener">three.js</a> - arcball controls<br />
            <a href="http://www.polycount.com/forum/showthread.php?t=130641" target="_blank" rel="noopener">Cerberus(FFVII Gun) model</a> by Andrew Maximov.
        </div>

        <!-- Import maps polyfill -->
        <!-- Remove this when import maps will be widely supported -->
        <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>

        <script type="importmap">
            {
                "imports": {
                    "three": "../build/three.module.js",
                    "three/addons/": "./jsm/"
                }
            }
        </script>

        <script type="module">
            import * as THREE from "three";
            import { ArcballControls } from "three/addons/controls/ArcballControls.js";

            let camera, controls, scene, renderer, circle;

            init();
            render();

            function init() {
                const container = document.createElement("div");
                document.body.appendChild(container);

                renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.setSize(window.innerWidth, window.innerHeight);

                renderer.toneMapping = THREE.ReinhardToneMapping;
                renderer.toneMappingExposure = 3;
                renderer.domElement.style.background = "linear-gradient( 180deg, rgba( 0,0,0,1 ) 0%, rgba( 128,128,255,1 ) 100% )";
                container.appendChild(renderer.domElement);

                //

                scene = new THREE.Scene();
                scene.add(new THREE.HemisphereLight(0x443333, 0x222233, 10));

                const fov = 100;
                const aspect = window.innerWidth / window.innerHeight;
                const near = 0.01;
                const far = 2000;
                camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
                camera.position.set(0, 10, 15);

                const geometry = new THREE.BoxGeometry(10, 10, 10);
                const material = new THREE.MeshStandardMaterial({ color: 0xffffff, side: THREE.DoubleSide, roughness: 0, metalness: 0.5 });
                circle = new THREE.Mesh(geometry, material);
                // circle.position.y = 0.5;
                // circle.rotation.x = Math.PI * 0.5;
                scene.add(circle);

                // circle
                // let outerR = 6;
                // let innerR = 3;
                // let h = 0.5;
                // let g = cylinderLathe(outerR, innerR, h);
                // let m = new THREE.MeshStandardMaterial({ color: "#F9F7D3", flatShading: true, metalness: 0.5 });
                // circle = new THREE.Mesh(g, m);
                // scene.add(circle);
                // function cylinderLathe(R, r, h) {
                //     let halfH = h * 0.5;
                //     let points = [new THREE.Vector2(r, -halfH), new THREE.Vector2(R, -halfH), new THREE.Vector2(R, halfH), new THREE.Vector2(r, halfH), new THREE.Vector2(r, -halfH)];
                //     let circle = new THREE.LatheBufferGeometry(points, 72);
                //     circle.receiveShadow = true;
                //     return circle;
                // }

                controls = new ArcballControls(camera, renderer.domElement, scene);
                controls.dampingFactor = 1;
                controls.enableZoom = false;
                // controls.enableRotate = false;
                controls.enablePan = false;
                controls.autoRotate = true;
                // controls.wMax = 5;
                // controls.setGizmosVisible(false);
                controls.addEventListener("change", render);
            }

            function render() {
                console.log(circle.rotation);
                // circle.rotation.y = 0;
                // circle.rotateX(0);
                requestAnimationFrame(render);
                controls.update();
                renderer.render(scene, camera);
            }
        </script>
    </body>
</html>
